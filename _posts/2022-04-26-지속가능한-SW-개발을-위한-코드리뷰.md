---
title: 지속가능한 SW 개발을 위한 코드리뷰
author: asy
date: 2021-04-26 17:12:00 -0500
categories: [코드 리뷰]
tags: [코드 리뷰]


---

# 지속가능한 SW 개발을 위한 코드리뷰

## 왜 코드 리뷰를 해야 하나?

### 우리가 살고 있는 시대

- 4차 산업 혁명
- ICT 융합으로 이뤄지는 차세대 산업 혁명
- VUCA
  - Volatiliy(변동성) : 변화의 속도가 빠르고 다양하게 전개될 것
  - Uncertaint(불확실성) : 미래 상황에 변수가 많아 예측하기 어려울 것
  - Complexity(복잡성) : 인과관계가 단순하지 않고 다양한 요인이 작용될 것
  - Ambiguity(모호성) : 뚜렷한 현상이 없어 판별하기 어려울 것
- 변동성의 시대

### 개발 생산성

- 설계 수익선 아래에서는 일정을 당기기 위해 설계 품질을 희생시키는 것이 의미가 있음
- 하지만 설계 수익선 이후에는 설꼐 품질 희생이 무의미

### SW 공학의 특성

- 공학 = 설계(Design) + 빌드(Build)
  - 설계 : 예측하기 어렵고, 급여가 비싸고 창의적인 사람들을 필요
  - 빌드 : 좀 더 예측하기 쉬움
- 설계와 빌드가 분리됨
- 빌드 비용이 비쌈(건축 90%)
- 공학 활동의 최종 목적
  - 빌드 할 수 있는 어떤 종류의 재생산 가능한 문서
- SW 공학의 설계와 빌드
  - 설계 = 완전한 소스코드
  - SW 빌드 = 컴파일
- 좋은 설계 ~= 클린 코드
- SW 엔지니어 : 설계를 잘하는 사람 -> 코드를 잘 작성하는 사람
- 클린 코드의 중요성
  - SW 의 진정한 비용 ~= 유지보수(전체의 80% 이상)
  - 한번 작성한 코드는 10번 이상 읽음. 작성 보다 이해에 10배의 노력 소요
  - 90% 이상의 시간을 어떤 코드를 이해하는데 사용함
- SW 개발의 단순한 진리
  - 시간이 흘러도 생산성 저하, 비용 증가를 막을 수 있는 유일한 방법
  - SW 품질에 신중해야
    - SW 의 비용과 품질의 관계는 비정상적, 비직관적
    - 향후 변경 비용을 낮춤으로써 익숙한 트레이드오프를 역전 시킴

### 장인 정신

- 애자일
  - VUCA 시대에 더 좋은 SW 개발 방법론
  - 단순 절차 변경 ? 개발 역량 ?
- 장인 정신
  - 지식과 경험의 공유 만이 전문성을 갖춘 개발자 육성
  - 후배들에게 지식과 경험을 공유(도제 관계)
- 코드 리뷰
  - **개발자가 지금부터 당장 행할 수 있는 공유 활동**
  - Code SNS 댓글 놀이
  - 배움을 주고 받으면 지속가능한 SW 개발자가 될 수 있는 실천법

### 목적

- 주목적 : 품질 문제 검수(버그,장애)
- 더 나은 코드 품질 : 아키텍처 속성 개선을 위한 코드 개선(향후 변경 비용 개선)
- 학습 및 지식 전달 : 코드, 해결책 등과 관련된 지식 공유에 기여
  - 공유(주고 받는 학습)를 통한 역량 증대 및 성장
  - 대개의 경우 리뷰어들도 리뷰 과정에서 지식을 얻게됨
- 상호 책임감 증대
  - 집단 코드 오너십 및 결속 증대
  - 내가 하고 있는 일에 관심을 가져주는 것
  - 팀에서 일어나는 일 공유, 내 동료는 무엇을 하나?
- 설계 개선 제안
- 개발 문화 개선

## 코드 리뷰의 절차

- 저자(Author)
  - 코드 작성, 리뷰 요청
- 리뷰어
  - 코드를 읽고 머지 가능한지 결정
- 변경 내역(Change List, PR)
  - 리뷰 시작전에 작성
  - 저자가 머지를 원하는 소스 코드에 대한 일련의 변경(잘한 것, 아쉬운 것, 눈여겨 볼 것)에 대해 기술

## 왜 코드 리뷰가 어려운가

- 코드 리뷰는
  - 지식 / 공학적 결정을 공유하는 기회
  - 공유(잘한 것, 아쉬운 것)를 통해 서로의 지식/경험을 나누며 상호 학습을 통한 역량 증대 수단
  - 코드 토의를 개인적 공격으로 받아들이면 물거품
- 생각을 글로 전달하는 것에 대한 어려움
  - 오해의 위험이 큼(음성 톤, 표정의 부재)
- 피드백을 조심스럽게 표현하는 것이 더 중요

## 기법들

#### 효율적인 PR 방법

- 지루한 작업은 컴퓨터로 처리
  - 코드를 읽는 것은 인지적 부담이되는 고수준의 집중이 요구되는 작업
    - 컴퓨터가 할 수 있는 있는 일에 이런 노력 낭비를 하지 말라
    - 심지어 기계가 더 잘 할 수 있는 일에
  - Formmatting Tool
    - 공백, 들여쓰기 오류 등
    - 별도의 커밋/PR 로 분리, 리뷰 불필요를 기술해서 리뷰를 생략할 수 있도록
- 스타일 가이드를 통해 스타일 논쟁을 해소
  - 스타일에 대한 논쟁은 리뷰에서 시간 낭비
- PR을 올릴 때 주석 달기
  - PR을 저자가 먼저 읽고 -> 리뷰어들을 위한 설명을 커맨트로 남겨서 -> 리뷰어들의 시간을 절약할 수 있게 하라
  - 많은 사람들이 볼 수록 버그를 더 잘 찾아낼 수 있다
- 모두를 포함하라
- 의미있는 커밋으로 분리

## 효율적인 리뷰 방법

### 리뷰는 즉시 시작

- 아침 스탠드 미팅에 익숙
- PR에 포함된 변경이 적도록 노력
- 근본적인 문제는 사람들이 리뷰할 시간이 없다고 느낌
  - 당신의 개인 기여로 평가를 받고 있다면 팀을 돕기 위해 수행하는 모든 일들이 시간 낭비처럼 보임
  - 리뷰를 하는 것의 문제라기보단 조직적인 문제
- Pull Requests VS Pair Programming
  - 두 가지 중 선택해서 하는 것보다 상황에 따라 달라짐

### 고수준으로 시작, 저수준으로

- 리뷰 라운드에서 많은 의견을 남길 수록, 저자가 당황할 위험 커짐
- 하나의 라운드에 20~50개 정도의 의견은 위험의 시작
- 초기 라운드에서는 고수준 피드백으로 제한
  - 버그, 장애, 성능, 보안 등
- 고수준의 피드백이 처리된 후에 저수준 이슈를 처리
  - 변수명

### 예제 코드 제공에 관대해라

- 저자를 기분 좋게 하기위한 방법
  - 리뷰 중 코드 예제
- 너무 긴 예제는 관대한 것이 아니라 억압적으로 보임

### 리뷰의 범위를 존중하라

- 자주 보이는 Anti-Pattern
  - PR 근처의 코드를 보고 저자에게 수정을 요청

### 한 두 등급만 코드 레벨을 올리는 것을 목표로

- 완전하지 않아도 충분히 좋은 코드가 되도록

### 피드백 방법

- 절대 "너"라고 하지마라
- 건설적인 피드백을 하라
- 진정한 칭찬을 해라
- 피드백은 명령이 아니라 요청으로 표현해라
- 의견이 아니라 원칙에 기반하여 피드백해라
- 반복적인 패턴에 대해서 피드백을 제한하라

## 교착 상태 시

### 교착 상태를 적극저긍로 처리해라

- 코드 리유의 최악의 결과는 교착 상태
  - 커멘트를 반영하지 않으니 승인거부
  - 저자는 커멘트 반영 거부
- 만나서 얘기하라
  - 화상 혹은 만나서 논의
  - 텍스트 기반의 소통은 상대가 인간이라는 것을 잊게 함
- 인정하거나 Escalate 하라
  - 교착 상태가 길어지면 관계가 나빠짐
  - 그냥 승인하는 비용
  - 동료와 너무 다퉈서 함께 일하지 않게 된다면 고수준의 품질을 얻을 기호가 사라짐
- 인정이 불가한 경우
  - 저자에게 논의를 팀장이나 테크 리더에게 Escalation\
  - 다른 리뷰어에게 할당
- 교착 상태로 부터 회복
  - 상황을 관리자와 논의하라
  - 휴식을 가져라
  - 갈등 해결책을 학습하라
- 설계 리뷰를 고려하라

## 추가적인 사례

### 코드 리뷰를 하는 재밌는 방법

- 결정은 저자가
  - 모든 설계 결함이 항상 실제로 문제가 되지 않음
- 코드 리뷰의 목적은 비난이 아니라 배움이다

## Appendix

### 코드 리뷰 문화 정착의 어려움

- 저자의 노력
  - 리뷰어 n 명의 시간을 절약
  - 효과적인 리뷰 가능
- 리더의 관심과 의지
  - 가끔 , 그러나 매우 자세히
- 코드 비난에 대한 두려움 없애야함
- 멋져 보여야
  - 하고 싶어짐, 그게 뭐든, 따라 하고 싶어져야